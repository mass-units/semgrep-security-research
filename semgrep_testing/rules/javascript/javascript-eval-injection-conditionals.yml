rules:
- id: javascript-eval-injection-conditionals
  patterns:
    - pattern-either: 
      - pattern: |
          function $F($A)
          {
            ...
            var $X = $A;
            ...
            if(...)
            ...
            eval($X);
          }
      - pattern: |
          function $F($A)
          {
            ...
            var $X = $A;
            ...
            if(...)
            ...
            else if(...)
            ...
            eval($X);
          }
    - pattern-not: |
        function $F($A)
        {
          ...
          var $X = $A;
          ...
          if(...)
          ...
          else if(...)
          ...
          else
          ...
          eval($X);
        }
  message: |
    Semgrep found a match
  severity: WARNING
